<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css"/>
        <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick-theme.css"/>
        
        <script>
        $(document).ready(function(){
            $("input.cusname").val(window.sessionStorage["cusname"]);
            $("input.email").val(window.sessionStorage["email"]);
            $("input.cellphone").val(window.sessionStorage["cellphone"]);
            $("input.address").val(window.sessionStorage["address"]);
            $("input.quantity").val(window.sessionStorage["quantity"]);
            $("input.quantity1").val(window.sessionStorage["quantity1"]);
            $("input.quantity2").val(window.sessionStorage["quantity2"]);
            $("input.quantity3").val(window.sessionStorage["quantity3"]);
            $("span.price").text(window.sessionStorage["totalprice"]);
        });
        function savedata(){
        window.sessionStorage["cusname"]=$("input.cusname").val();
        window.sessionStorage["email"]=$("input.email").val();
        window.sessionStorage["cellphone"]=$("input.cellphone").val();
        window.sessionStorage["address"]=$("input.address").val();
        window.sessionStorage["quantity"]=$("input.quantity").val();
        window.sessionStorage["quantity1"]=$("input.quantity1").val();
        window.sessionStorage["quantity2"]=$("input.quantity2").val();
        window.sessionStorage["quantity3"]=$("input.quantity3").val();
        window.sessionStorage["totalprice"]=$("span.price").text();
        alert("已成功儲存資料囉！\n請注意，如果關閉瀏覽器資料便會自動清除唷！")
        
        }
    
        
　 　　	function count(){
　 　　	    $("span.SP-tran-price").text("150");
　 　　	    $("span.tran-price").text("80");
　 　　	  
　 　　		var quantity=$("input.quantity").val();
　 　　		var quantity1=$("input.quantity1").val();
　 　　		var quantity2=$("input.quantity2").val();
　 　　		var quantity3=$("input.quantity3").val();
　 　　		if(quantity<0){
　 　　		 quantity=0;	
　 　　		 $("input.quantity").val(0);
　 　　		}
　 　　		if(quantity1<0){
　 　　				quantity1=0;	
　 　　	　		 $("input.quantity1").val(0);
　 　　		}
　 　　		if(quantity2<0){
　 　　				quantity2=0;	
　 　　　		 $("input.quantity2").val(0);
　 　　		}
　 　　		if(quantity3<0){
　 　　				quantity3=0;	
　 　　	　		 $("input.quantity3").val(0);
　 　　		}
            var SPprice=0;
            var Normalprice=0;
　 　　		if(quantity>0){
　 　　		    SPprice=50*quantity+150;
　 　　		}
　 　　		if(quantity1>0||quantity2>0||quantity3>0){
　 　　		    Normalprice=120*quantity1+120*quantity2+158*quantity3+80;
　 　　		}
　 　　		if(Normalprice-80>=500){
　 　　		    Normalprice-=80
　 　　		    $("span.tran-price").text("0");
　 　　		}
　 　　		if(quantity>19){
　 　　		    SPprice-=150
　 　　		    $("span.SP-tran-price").text("0");
　 　　		}
　 　　		var totalprice=SPprice+Normalprice;
　 　　		$("span.SP-totalprice").text(SPprice);
　 　　		$("span.totalprice").text(Normalprice);
　 　　		$("span.price").text(totalprice);
　 　　	}
　　    </script>
    </head>

<body style="font-family:Microsoft JhengHei">

<div style="margin:70px"></div>

<div style="margin-bottom:20px">
    <h1 style="color:#008000"><b>顧客資料</b></h1>
    <%= simple_form_for @customer do |f|%>
        <%= f.input :cusname, class: 'cusname', label:'名稱', placeholder:'請輸入姓名' %>
        <%= f.input :email, class: 'email', label:'電子信箱', placeholder:'example@mail.com' %>
        <%= f.input :cellphone, class: 'cellphone', label:'連絡電話', placeholder:'09xxxxxxxx' %>
        <%= f.input :address, class: 'address', label:'送貨地址', placeholder:'宅配地址或是門市編號（如：全家0000）', hint:'點擊右方按鈕可查詢門市編號', size:'32' %>
        <a class="btn btn-info" style="float:right; margin:-30px 5px 0 5px" onclick="window.open('http://www.family.com.tw/Marketing/inquiry.aspx')">全家</a>
        <a class="btn btn-info" style="float:right; margin:-30px 5px 0 5px" onclick="window.open('http://www.hilife.com.tw/storeInquiry_street.aspx')">萊爾富</a>
        <a class="btn btn-info" style="float:right; margin:-30px 5px 0 5px" onclick="window.open('http://www.okmart.com.tw/convenient_shopSearch')">OK</a>
    <% end %>    
</div>

<div>
    <h1 style="color:#008000"><b>故事需求</b></h1>
    <%= simple_form_for @customer do |f|%>
        <%= link_to "冰心地瓜", "1",  rel: "nofollow" %>
        <%= f.input :productnumber, label:'50元/包', :input_html => {class:'quantity', :onchange =>"count()" , :onkeyup =>"this.onchange()", :onpaste =>"this.onchange()", :oninput =>"this.onchange()"} %>
       <div style="font-size:20px">
            <b>+低溫運費<span class="SP-tran-price" style=" margin:0 5px 0 10px; margin-top:10px">150</span>元</b>
            <BR><b>=地瓜總價格<span class="SP-totalprice" style="margin:0 5px 0 10px; margin-top:10px">0</span>元</b>
       </div>
        <%= link_to "玉米好棒棒", "2", rel: "nofollow" %>
        <%= f.input :productnumber1, label:'120元/包', :input_html => {class:'quantity1', :onchange =>"count()" , :onkeyup =>"this.onchange()", :onpaste =>"this.onchange()", :oninput =>"this.onchange()"} %>
        <%= link_to "樂樂雞蛋捲", "3", rel: "nofollow" %>
        <%= f.input :productnumber2, label:'120元/盒', :input_html => {class:'quantity2', :onchange =>"count()" , :onkeyup =>"this.onchange()", :onpaste =>"this.onchange()", :oninput =>"this.onchange()"} %>
         <%= link_to "阿公的香水檸檬", "4", rel: "nofollow" %>
        <%= f.input :productnumber3, label:'158元/包', :input_html => {class:'quantity3', :onchange =>"count()" , :onkeyup =>"this.onchange()", :onpaste =>"this.onchange()", :oninput =>"this.onchange()"} %>
        <div style="font-size:20px">
            <b>+常溫運費<span class="tran-price" style=" margin:0 5px 0 10px; margin-top:10px">80</span>元</b>
            <BR><b>=常溫品總價格<span class="totalprice" style=" margin:0 5px 0 10px; margin-top:10px">0</span>元</b>
       </div>
        <div style="font-size:20px">
            <BR><b>總價格<span class="price" style="font-size:40px; color:red; margin:0 5px 0 10px">0</span>元</b>
          	<span style="float:right; margin-top:10px">
               	<button class="btn btn-success" style="margin-right:5px" onclick="savedata()">儲存</button>
                <%= f.submit "投資夢想", class: "btn btn-primary"%>
          	</span>        
      	</div>
      	<div style="height:100px"></div>
    <%end%>
</div>
</body>
</html>